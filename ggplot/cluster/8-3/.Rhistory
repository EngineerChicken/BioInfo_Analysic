library("FactoMineR")
library("factoextra")
data(decathlon2)
decathlon2.active <- decathlon2[1:23, 1:10]
head(decathlon2.active[, 1:6], 4)
library("FactoMineR")
library("factoextra")
data(decathlon2)
decathlon2.active <- decathlon2[1:23, 1:10]
head(decathlon2.active[, 1:7], 4)
library("FactoMineR")
library("factoextra")
data(decathlon2)
decathlon2.active <- decathlon2[1:23, 1:10]
head(decathlon2.active[, 1:6], 4)
library("FactoMineR")
library("factoextra")
data(decathlon2)
decathlon2.active <- decathlon2[1:23, 1:10]
head(decathlon2.active[, , 4)
head(pca_file[,1:6,4])
head(pca_file[,1:7,4])
res2.pca <- PCA(pca_file, graph = FALSE)
pca_file.active <- pca_file[1:765, 1:7]
head(pca_file.active[, 1:6], 4)
head(pca_file.active[, 1:7], 4)
decathlon2.active <- decathlon2[1:23, 1:10]
head(decathlon2.active[, 1:6], 4)
head(pca_file.active[, 2:7], 4)
pca_file.active <- pca_file[1:765, 2:7]
res2.pca <- PCA(pca_file.active, graph = FALSE)
eig.val <- get_eigenvalue(res2.pca)
fviz_eig(res2.pca, addlabels = TRUE, ylim = c(0, 50))
fviz_eig(res2.pca, addlabels = TRUE, ylim = c(0, 100))
fviz_pca_var(res2.pca, col.var = "black")
library(pheatmap)
input="diff.7vs7.txt";
output="diff.7vs7.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
setwd("~/R_Workspace/cluster/8-3")
library(pheatmap)
input="diff.7vs7.txt";
output="diff.7vs7.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="diff.FDR0.01.7VS7.txt";
output="diff.7vs7.2.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="diff.FDR0.01.5VS7.txt";
output="diff.7vs7.2.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.2.txt";
output="diff.7vs7.3.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.2.txt";
output="diff.7vs7.3.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="none",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.2.txt";
output="diff.7vs7.3.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="column",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.2.txt";
output="diff.7vs7.3.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.txt";
output="ACFVSALI.rpkm.out.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.2.txt";
output="ACFVSALI.rpkm.2.out.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.3.txt";
output="ACFVSALI.rpkm.3.out.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.3.txt";
output="ACFVSALI.rpkm.3.out.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t")
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.3.txt";
output="ACFVSALI.rpkm.3.out.pdf";
data<- read.table(input,head = T,row.names=1,sep="\t",col.names = c(1,2,4))
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
library(pheatmap)
input="ACFVSALI.rpkm.3.txt";
output="ACFVSALI.rpkm.3.out.pdf";
data<- read.table(input,head = T,row.names=c(1,2,4),sep="\t",col.names = c(1,2,4))
pheatmap(data,
scale="row",#按列均一化，"row","column" or "none"默认是"none"
#clustering_distance_rows = "correlation",#聚类线长度优化
treeheight_row=40,#按行聚类树高
treeheight_col=40,#按列聚类树高
cluster_cols=T,#是否按列聚类
cluster_rows=T,#是否按行聚类
display_numbers=F,#是否在每一格上显示数据
number_format="%.2f",#显示数据的格式，几位小数，或"\%.1e"，颜色number_color,大小fontsize_number
fontsize_row=10,#行名称字体大小
fontsize_col=15,#列名称字体大小
#格子大小
cellwidth = 50,
cellheight= 14,
#main="ABC",#标题名称
#gaps_row = c(10, 15),#插入缝隙，不能聚类！
cutree_row = 7,#按聚类分割
show_colnames=TRUE,#是否显示列名，同理show_rownames
show_rownames=T,
#定义颜色"navy", "white", "firebrick3"
#color = colorRampPalette(c("green","black","red"),bias=2.5)(256),
#color = colorRampPalette(c("green","black","red"))(256),
color = colorRampPalette(c("MediumBlue","white","red"))(256),
border_color = "black"
,#格子框颜色
legend = FALSE,#是否显示图例
legend_breaks = -1:4,#图例范围
#output = "trf1.pdf",#保存文件命名
filename = output
)
